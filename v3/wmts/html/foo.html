<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">

    <link rel="stylesheet" href="http://openlayers.org/en/v3.9.0/css/ol.css" type="text/css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <style  type="text/css">
        html, body, .map {
            padding: 0;
            width: 100%;
            height: 100%;
            position: relative;
            margin: 0 auto;
            overflow: hidden;
        }

        #layer-select {
            right: 1em;
            top: 2em;
            position: absolute;
            width: 160px;
        }
    </style>
    <title>WMTS</title>
</head>
  <body>
    <script src="http://openlayers.org/en/v3.9.0/build/ol.js" type="text/javascript"></script>
    <div id="map" class="map"></div>
    <script type="text/javascript">

      var layerName = getParameterByName('layer');

      var projection = new ol.proj.Projection({
          code: 'EPSG:21781',
          extent: [420000, 30000, 900000, 350000],
          units: 'm'
      });

      var projectionExtent = projection.getExtent();
      var zoomLevels = 29;
      var resolutions = [4000,3750,3500,3250,3000,2750,2500,2250,2000,1750,1500,1250,1000,750,650,500,250,100,50,20,10,5,2.5,2,1.5,1,0.5,0.25,0.1];
      //var matrixIds = new Array(zoomLevels);
      var matrixIds = new Array(resolutions.length);

      for (var z = 0; z < zoomLevels; ++z) {
          matrixIds[z] = z;
      }

      var layer = new ol.layer.Tile({
          layerName: "Orthofoto NDVI", // TODO
          layerId: "orthofoto_ndvi", // TODO
          baselayer: true,
          visible: true,
          source: new ol.source.WMTS({
              url: "http://www.catais.org/mapcache/wmts/1.0.0/{Layer}/default/21781/" + "{TileMatrix}/{TileRow}/{TileCol}",
              layer: layerName,
              requestEncoding: 'REST',
              matrixSet: '21781',
              format: 'image/jpeg', // change this according to the layers...
              projection: projection,
              tileGrid: new ol.tilegrid.WMTS({
                  origin: ol.extent.getTopLeft(projectionExtent),
                  resolutions: resolutions,
                  matrixIds: matrixIds
              }),

              //extent: [590000, 210000, 645000, 262000],
              style: 'default'
          })
      });

      var map = new ol.Map({
          renderer: 'canvas',
          //renderer: 'dom',
          controls: ol.control.defaults().extend([
              new ol.control.FullScreen(),
          ]),
          ol3Logo: false,
          target: document.getElementById('map'),
          layers: [
              layer
          ],
          view: new ol.View({
              projection: projection,
              center: [607100, 226700],
              zoom: 21,
              resolutions: [4000,3750,3500,3250,3000,2750,2500,2250,2000,1750,1500,1250,1000,750,650,500,250,100,50,20,10,5,2.5,2,1.5,1,0.5,0.25,0.1,0.05]
          })
      });

      function getParameterByName(name) {
          var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
          return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
      }

    </script>
  </body>
</html>
